<html>
<head><title>.eunit/webmachine_error_handler.COVER.html</title></head><body bgcolor=white text=black>
<pre>
File generated from /Users/seb/Documents/part2project/app/deps/webmachine/.eunit/webmachine_error_handler.erl by COVER 2010-10-28 at 14:19:55

****************************************************************************

        |  %% @author Justin Sheehy &lt;justin@basho.com&gt;
        |  %% @author Andy Gross &lt;andy@basho.com&gt;
        |  %% @author Jeremy Latt &lt;jeremy@basho.com&gt;
        |  %% @copyright 2007-2008 Basho Technologies
        |  %%
        |  %%    Licensed under the Apache License, Version 2.0 (the "License");
        |  %%    you may not use this file except in compliance with the License.
        |  %%    You may obtain a copy of the License at
        |  %%
        |  %%        http://www.apache.org/licenses/LICENSE-2.0
        |  %%
        |  %%    Unless required by applicable law or agreed to in writing, software
        |  %%    distributed under the License is distributed on an "AS IS" BASIS,
        |  %%    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
        |  %%    See the License for the specific language governing permissions and
        |  %%    limitations under the License.
        |  
        |  
        |  %% @doc Some fairly minimal error message formatters.
        |  
        |  -module(webmachine_error_handler).
        |  -author('Justin Sheehy &lt;justin@basho.com&gt;').
        |  -author('Andy Gross &lt;andy@basho.com&gt;').
        |  -author('Jeremy Latt &lt;jeremy@basho.com&gt;').
        |  
        |  -export([render_error/3]).
        |  
        |  render_error(Code, Req, Reason) -&gt;
<font color=red>     0..|      case Req:has_response_body() of</font>
<font color=red>     0..|          {true,_} -&gt; Req:response_body();</font>
<font color=red>     0..|          {false,_} -&gt; render_error_body(Code, Req:trim_state(), Reason)</font>
        |      end.
        |  
        |  render_error_body(404, Req, _Reason) -&gt;
<font color=red>     0..|      {ok, ReqState} = Req:add_response_header("Content-Type", "text/html"),</font>
<font color=red>     0..|      {&lt;&lt;"&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;404 Not Found&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;Not Found&lt;/H1&gt;The requested document was not found on this server.&lt;P&gt;&lt;HR&gt;&lt;ADDRESS&gt;mochiweb+webmachine web server&lt;/ADDRESS&gt;&lt;/BODY&gt;&lt;/HTML&gt;"&gt;&gt;, ReqState};</font>
        |  
        |  render_error_body(500, Req, Reason) -&gt;
<font color=red>     0..|      {ok, ReqState} = Req:add_response_header("Content-Type", "text/html"),</font>
<font color=red>     0..|      {Path,_} = Req:path(),</font>
<font color=red>     0..|      error_logger:error_msg("webmachine error: path=~p~n~p~n", [Path, Reason]),</font>
<font color=red>     0..|      STString = io_lib:format("~p", [Reason]),</font>
<font color=red>     0..|      ErrorStart = "&lt;html&gt;&lt;head&gt;&lt;title&gt;500 Internal Server Error&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Internal Server Error&lt;/h1&gt;The server encountered an error while processing this request:&lt;br&gt;&lt;pre&gt;",</font>
<font color=red>     0..|      ErrorEnd = "&lt;/pre&gt;&lt;P&gt;&lt;HR&gt;&lt;ADDRESS&gt;mochiweb+webmachine web server&lt;/ADDRESS&gt;&lt;/body&gt;&lt;/html&gt;",</font>
<font color=red>     0..|      ErrorIOList = [ErrorStart,STString,ErrorEnd],</font>
<font color=red>     0..|      {erlang:iolist_to_binary(ErrorIOList), ReqState};</font>
        |  
        |  render_error_body(501, Req, _Reason) -&gt;
<font color=red>     0..|      {ok, ReqState} = Req:add_response_header("Content-Type", "text/html"),</font>
<font color=red>     0..|      {Method,_} = Req:method(),</font>
<font color=red>     0..|      error_logger:error_msg("Webmachine does not support method ~p~n",</font>
        |                             [Method]),
<font color=red>     0..|      ErrorStr = io_lib:format("&lt;html&gt;&lt;head&gt;&lt;title&gt;501 Not Implemented&lt;/title&gt;"</font>
        |                               "&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Internal Server Error&lt;/h1&gt;"
        |                               "The server does not support the ~p method.&lt;br&gt;"
        |                               "&lt;P&gt;&lt;HR&gt;&lt;ADDRESS&gt;mochiweb+webmachine web server"
        |                               "&lt;/ADDRESS&gt;&lt;/body&gt;&lt;/html&gt;",
        |                               [Method]),
<font color=red>     0..|      {erlang:iolist_to_binary(ErrorStr), ReqState};</font>
        |  
        |  render_error_body(503, Req, _Reason) -&gt;
<font color=red>     0..|      {ok, ReqState} = Req:add_response_header("Content-Type", "text/html"),</font>
<font color=red>     0..|      error_logger:error_msg("Webmachine cannot fulfill"</font>
        |                             " the request at this time"),
<font color=red>     0..|      ErrorStr = "&lt;html&gt;&lt;head&gt;&lt;title&gt;503 Service Unavailable&lt;/title&gt;"</font>
        |                 "&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Service Unavailable&lt;/h1&gt;"
        |                 "The server is currently unable to handle "
        |                 "the request due to a temporary overloading "
        |                 "or maintenance of the server.&lt;br&gt;"
        |                 "&lt;P&gt;&lt;HR&gt;&lt;ADDRESS&gt;mochiweb+webmachine web server"
        |                 "&lt;/ADDRESS&gt;&lt;/body&gt;&lt;/html&gt;",
<font color=red>     0..|      {list_to_binary(ErrorStr), ReqState}.</font>
        |  
</pre>
</body>
</html>
